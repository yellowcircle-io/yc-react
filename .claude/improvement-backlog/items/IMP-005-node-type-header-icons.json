{
  "id": "IMP-005",
  "title": "Node Type Header Icons (3 nodes missing icons)",
  "round": 1,
  "status": "running",
  "priority": 5,
  "complexity": "simple",
  "model": "sonnet",
  "blockedBy": [
    "IMP-001"
  ],
  "competitiveRationale": "Milanote shows type-specific icons on card headers for quick visual identification. Three of our nodes (CodeBlockNode, GroupNode, LinkNode) lack a header type icon. The other 5 nodes already have icons and must NOT be modified.",
  "relatedScope": "dev-context/SCOPE_UNITYNOTES_UIUX_IMPROVEMENTS.md",
  "scopeSection": "Feature Details > 2. Enhanced Card Design",
  "objective": "Add a header type icon ONLY to the 3 nodes that currently lack one: CodeBlockNode, GroupNode, and LinkNode. Do NOT modify nodes that already have header icons (TodoNode, CommentNode, ColorSwatchNode, MapNode, TripPlannerMapNode). For CodeBlockNode: add a Code icon import from lucide-react and render it in the header area next to the language selector. For GroupNode: the Layers icon already exists but is only shown in the bottom-right corner \u2014 add a second Layers icon render in the header/label area. For LinkNode: add a Link2 icon import from lucide-react and render it in the header area near the domain/title display.",
  "existingState": {
    "TodoNode": "ALREADY HAS CheckSquare icon in header via unity-node-header-icon class \u2014 DO NOT TOUCH",
    "CommentNode": "ALREADY HAS MessageSquare icon in header (line 315) \u2014 DO NOT TOUCH",
    "ColorSwatchNode": "ALREADY HAS Palette icon in header via unity-node-header-icon class \u2014 DO NOT TOUCH",
    "MapNode": "ALREADY HAS \ud83d\uddfa\ufe0f emoji icon in header \u2014 DO NOT TOUCH",
    "TripPlannerMapNode": "ALREADY HAS \ud83d\uddfa\ufe0f emoji icon in header \u2014 DO NOT TOUCH",
    "CodeBlockNode": "NO header icon. Has window chrome buttons (red/yellow/green dots). Imports X, Star only.",
    "GroupNode": "Layers icon imported but only rendered in bottom-right corner. No header icon.",
    "LinkNode": "NO header icon. Has favicon in content area and SVG globe fallback. No lucide icon imports."
  },
  "allowedFiles": [
    "src/components/unity-plus/nodes/CodeBlockNode.jsx",
    "src/components/unity-plus/nodes/GroupNode.jsx",
    "src/components/unity-plus/nodes/LinkNode.jsx"
  ],
  "forbiddenFiles": [
    "src/components/unity-plus/nodes/TodoNode.jsx",
    "src/components/unity-plus/nodes/CommentNode.jsx",
    "src/components/unity-plus/nodes/ColorSwatchNode.jsx",
    "src/components/unity-plus/nodes/MapNode.jsx",
    "src/components/unity-plus/nodes/TripPlannerMapNode.jsx",
    "src/components/unity-plus/nodes/StickyNode.jsx",
    "src/components/unity-plus/TextNoteNode.jsx",
    "src/pages/UnityNotesPage.jsx"
  ],
  "maxLinesChanged": 60,
  "pattern": {
    "description": "Add a small type icon to the header area of each node, following the existing unity-node-header-icon pattern used by TodoNode and ColorSwatchNode.",
    "example": "<div className=\"unity-node-header-icon\" style={{ color: '#nodeColor' }}><IconName size={20} strokeWidth={2} /></div>",
    "notes": "Match the existing pattern in TodoNode (lines 151-153) and ColorSwatchNode (lines 166-168). Icon should be 20px size, strokeWidth 2, wrapped in a div with className 'unity-node-header-icon'. Place it at the start of the header flex row. CodeBlockNode: import Code from lucide-react, add before language selector. GroupNode: Layers is already imported, add to the label/title area. LinkNode: import Link2 from lucide-react, add to the domain/title display area."
  },
  "acceptanceCriteria": [
    "CodeBlockNode has a Code icon (20px) in its header area",
    "GroupNode has a Layers icon (20px) in its header/label area",
    "LinkNode has a Link2 icon (20px) in its header area",
    "Icons use the unity-node-header-icon className pattern",
    "ONLY these 3 files are modified \u2014 no other node files touched",
    "Existing functionality (language selector, resize handles, link preview) unchanged",
    "npm run lint passes",
    "npm run build succeeds"
  ],
  "attempts": [
    {
      "timestamp": "2026-01-28T21:44:34Z",
      "result": "success",
      "reason": "All 4 gates passed"
    },
    {
      "timestamp": "2026-01-28T22:10:00Z",
      "result": "rejected",
      "reason": "Human rejected: Added duplicate icons to nodes that already had header icons (TodoNode, CommentNode, ColorSwatchNode, MapNode, TripPlannerMapNode). Reverted. Spec rewritten to only target 3 nodes that lack icons: CodeBlockNode, GroupNode, LinkNode."
    }
  ],
  "maxAttempts": 3,
  "createdAt": "2026-01-27",
  "branch": "sleepless/IMP-005-node-type-header-icons",
  "prUrl": ""
}
